with source as (
    
	select * from {{ ref('atmdata_staging') }}
    
),

casted as (
    select 
        cast(ingestion_time as TIMESTAMP_NTZ(9)) as ingestion_time,
        cast(ATMTRANSID as varchar(100)) as ATMTRANSID,
        cast(ATMDEVICEID as varchar(100)) as ATMDEVICEID,
        cast(POSTINGDATE as TIMESTAMP_NTZ(9)) as POSTINGDATE,
        cast(TRANSSEQ as varchar(55)) as TRANSSEQ,
        cast(SOURCECIB as varchar(103)) as SOURCECIB,
        cast(ATMCARDNUMBER as varchar(100)) as ATMCARDNUMBER,
        cast(CARDSEQUENCENUMBER as varchar(100)) as CARDSEQUENCENUMBER,
        cast(ACCOUNTID as float) as ACCOUNTID,
		cast(ACCOUNTCURRENCY as varchar(100)) as ACCOUNTCURRENCY,
		cast(AMOUNTDISPENSED as float) as AMOUNTDISPENSED,
		cast(BASEEQUIVALENT as varchar(55)) as BASEEQUIVALENT,
		cast(COMMAMOUNT as varchar(55)) as COMMAMOUNT,
		cast(ISOCURRENCYCODE as varchar(55)) as ISOCURRENCYCODE,
		cast(ATMTRANSACTIONCODE as varchar(100)) as ATMTRANSACTIONCODE,
		cast(MISTRANSACTIONCODE as varchar(55)) as MISTRANSACTIONCODE,
		cast(ATMTRANDESC as varchar(150)) as ATMTRANDESC,
		cast(DESTACCOUNTID as varchar(100)) as DESTACCOUNTID,
		cast(FORCEPOST as varchar(100)) as FORCEPOST,
		cast(ERRORSTATUS as varchar(100)) as ERRORSTATUS,
		cast(ERRORDESC as varchar(255)) as ERRORDESC,
		cast(VERSIONNUM as varchar(100)) as VERSIONNUM,
		cast(AUTHORIZEDFLAG as varchar(100)) as AUTHORIZEDFLAG,
		cast(TRANSACTIONREFERENCE as float) as TRANSACTIONREFERENCE,
		cast(MSGRECVDATETIME as TIMESTAMP_NTZ(9)) as MSGRECVDATETIME,
		cast(TRANSACTIONDATE as TIMESTAMP_NTZ(9)) as TRANSACTIONDATE,
		cast(TRANSACTIONAMOUNT as float) as TRANSACTIONAMOUNT,
		cast(ISDELETED as varchar(55)) as ISDELETED,
		cast(ISARCHIVED as varchar(55)) as ISARCHIVED,
		cast(TRANSACTIONID as varchar(100)) as TRANSACTIONID,
		cast(CHEQUEREFERENCE as varchar(55)) as CHEQUEREFERENCE,
		cast(ODI_LANDING_ID as varchar(100)) as ODI_LANDING_ID,
		cast(ROW_INSERTED as TIMESTAMP_NTZ(9)) as ROW_INSERTED
    from source 
),
renamed as (
    select 
        ingestion_time as ingestion_time,
        ATMTRANSID as ATMTRANSID,
        ATMDEVICEID as ATMDEVICEID,
        POSTINGDATE as POSTINGDATE,
        TRANSSEQ as TRANSSEQ,
        SOURCECIB as SOURCECIB,
        ATMCARDNUMBER as ATMCARDNUMBER,
        CARDSEQUENCENUMBER as CARDSEQUENCENUMBER,
        ACCOUNTID as ACCOUNTID,
		ACCOUNTCURRENCY as ACCOUNTCURRENCY,
		AMOUNTDISPENSED as AMOUNTDISPENSED,
		BASEEQUIVALENT as BASEEQUIVALENT,
		COMMAMOUNT as COMMAMOUNT,
		ISOCURRENCYCODE as ISOCURRENCYCODE,
		ATMTRANSACTIONCODE as ATMTRANSACTIONCODE,
		MISTRANSACTIONCODE as MISTRANSACTIONCODE,
		ATMTRANDESC as ATMTRANDESC,
		DESTACCOUNTID as DESTACCOUNTID,
		FORCEPOST as FORCEPOST,
		ERRORSTATUS as ERRORSTATUS,
		ERRORDESC as ERRORDESC,
		VERSIONNUM as VERSIONNUM,
		AUTHORIZEDFLAG as AUTHORIZEDFLAG,
		TRANSACTIONREFERENCE as TRANSACTIONREFERENCE,
		MSGRECVDATETIME as MSGRECVDATETIME,
		TRANSACTIONDATE as TRANSACTIONDATE,
		TRANSACTIONAMOUNT as TRANSACTIONAMOUNT,
		ISDELETED as ISDELETED,
		ISARCHIVED as ISARCHIVED,
		TRANSACTIONID as TRANSACTIONID,
		CHEQUEREFERENCE as CHEQUEREFERENCE,
		ODI_LANDING_ID as ODI_LANDING_ID,
		ROW_INSERTED as ROW_INSERTED
    from casted 
)
select * from renamed
